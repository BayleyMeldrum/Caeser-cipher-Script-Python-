# Function to handle the entire encryption/decryption process
def encrypt_decrypt_process():
    # Asks the user if they are encrypting or decrypting text
    choice = input("If you are encrypting text, please enter 'encrypt'. If you are decrypting text, please enter 'decrypt': ")

    # If statement that checks if users are encrypting or decrypting texts
    if choice == "decrypt":
        # Input validation loop for text containing only letters and spaces
        while True:
            text = input("Please enter your text: ")
            if all((char.isalpha() or char.isspace() for char in text)):
                break
            else:
                print("Invalid input. Please enter text containing only letters and spaces.")
        
        # Number input validation loop
        while True:
            try:
                # Asks the user what secret number they would like to use to encrypt their message and stores it as a variable
                s = int(input("Please input your secret number: "))
                break  # Exit the loop if the input is a valid integer
            except ValueError:
                print("Invalid input. Please enter a valid number.")

        # Decrypts the text that the user inputs
        def decrypt(text, s):
            result = ""

            # Traverse text
            for char in text:
                # Decrypt uppercase characters
                if char.isupper():
                    result += chr((ord(char) - s - 65) % 26 + 65)
                # Decrypt lowercase characters
                else:
                    result += chr((ord(char) - s - 97) % 26 + 97)

            return result

        # Outputs the text that the user put in, along with a decrypted version and the secret number
        print("Input Text: " + text)
        print("Shift: " + str(s))
        print("Output Text: " + decrypt(text, s))

    elif choice == "encrypt":
        # Input validation loop for text containing only letters and spaces
        while True:
            text = input("Please enter your text: ")
            if all((char.isalpha() or char.isspace() for char in text)):
                break
            else:
                print("Invalid input. Please enter text containing only letters and spaces.")
        
        # Number input validation loop
        while True:
            try:
                # Asks the user for the secret number used to encrypt the message and stores it as a variable
                s = int(input("Please enter the secret number: "))
                break  # Exit the loop if the input is a valid integer
            except ValueError:
                print("Invalid input. Please enter a valid number.")
        
        # Encrypts the text that the user inputs
        def encrypt(text, s):
            result = ""

            # Traverse text
            for char in text:
                # Encrypt uppercase characters
                if char.isupper():
                    result += chr((ord(char) + s - 65) % 26 + 65)
                # Encrypt lowercase characters
                else:
                    result += chr((ord(char) + s - 97) % 26 + 97)

            return result

        # Outputs the text that the user entered, along with the encrypted version and the secret number
        print("Input Text: " + text)
        print("Shift: " + str(s))
        print("Output Text: " + encrypt(text, s))

    # Outputs text that tells the user to restart the program if they spelled 'encrypt' or 'decrypt' wrong
    else:
        print("Invalid choice. Please enter either 'encrypt' or 'decrypt' correctly.")

# Main loop to restart the script if the user wants to
while True:
    encrypt_decrypt_process()

    # Ask if the user wants to restart
    restart = input("Do you want to encrypt/decrypt again? (yes/no): ")

    # If the user doesn't want to restart, break the loop and end the program
    if restart.lower() != "yes":
        print("Thank you for using this program. Goodbye!")
        break
